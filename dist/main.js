(()=>{"use strict";class e{constructor(e,t,o,n){this.length=e,this.hits=[],this.killed=!1,this.coordinateX=t,this.coordinateY=o,this.position=n,this.coordinates=[]}hit(e,t){return this.hits.push({coordinateX:e,coordinateY:t}),this.hits.length}isSunk(){return this.length-this.hits.length==0&&(this.killed=!0,console.log("killed"),!0)}}let t=!1;class o{constructor(){this.ships=[],this.hitsMissed=[],this.sunkedShips=0}addShip(o,i,s,r){const a=new e(s,o,i,r);if(o=+o,i=+i,1===a.length?a.coordinates.push({x:o,y:i}):2===a.length&&"vertical"===a.position?a.coordinates.push({x:o,y:i},{x:o,y:i+1}):2===a.length&&"horizontal"===a.position?a.coordinates.push({x:o,y:i},{x:o+1,y:i}):3===a.length&&"vertical"===a.position?a.coordinates.push({x:o,y:i},{x:o,y:i+1},{x:o,y:i+2}):3===a.length&&"horizontal"===a.position&&a.coordinates.push({x:o,y:i},{x:o+1,y:i},{x:o+2,y:i}),this.ships.length>0)for(let e=0;e<this.ships.length;e++){let t=this.ships[e].coordinates,o=a.coordinates;for(let e=0;e<t.length;e++){if(o[0].x===t[e].x&&o[0].y===t[e].y)return"This coordinates are use";if(o[0].x===t[e].x+1&&o[0].y===t[e].y+1)return"This coordinates are use";if(o[0].x===t[e].x-1&&o[0].y===t[e].y-1)return"This coordinates are use";if(a.length>1){if(o[1].x===t[e].x&&o[1].y===t[e].y)return"This coordinates are use";if(o[1].x===t[e].x+1&&o[1].y===t[e].y+1)return"This coordinates are use";if(o[1].x===t[e].x-1&&o[1].y===t[e].y-1)return"This coordinates are use"}if(a.length>2){if(o[2].x===t[e].x&&o[2].y===t[e].y)return"This coordinates are use";if(o[2].x===t[e].x+1&&o[2].y===t[e].y+1)return"This coordinates are use";if(o[2].x===t[e].x-1&&o[2].y===t[e].y-1)return"This coordinates are use"}}}if(this.ships.push(a),!0===t)return;const d=document.getElementsByClassName("gameBoardDiv");let l;return l=0===i?o:10*i+o,d[l].style="background-color:green;","horizontal"===r?2===a.length?d[l+1].style="background-color:green;":3===a.length&&(d[l+1].style="background-color:green;",d[l+2].style="background-color:green;"):"vertical"===r&&(2===a.length?d[l+10].style="background-color:green;":3===a.length&&(d[l+10].style="background-color:green;",d[l+20].style="background-color:green;")),9===n.gameboard.ships.length&&(t=!0),a}receiveAttack(e,t){for(let o=0;o<this.ships.length;o++){let n=this.ships[o].coordinates;for(let i=0;i<n.length;i++)if(n[i].x===e&&n[i].y===t)return this.ships[o].hit(e,t),this.ships[o].isSunk()?(this.sunkedShips++,console.log(this.sunkedShips),this.endGame()):this.ships[o].hits}let o;return o=0==t?+e:10*+t+e,this.hitsMissed.push(o),o}endGame(){return this.sunkedShips===this.ships.length&&console.log("finish"),!1}}const n=new class{constructor(){this.shoots=[],this.gameboard=new o,this.score=this.gameboard.sunkedShips}welcome(){const e=document.querySelector(".preLoad div input");document.querySelector("#yourName").innerHTML=e.value}addShips(e,t,o,n){return this.gameboard.addShip(e,t,o,n),this.gameboard}shoot(e,t){let o={x:e,y:t};return this.shoots.push(o),o}},i=e=>{let t;"player"===e?t=document.querySelector("#divHolder"):"AI"===e&&(t=document.querySelector(`#div${e}Holder`));let o=0;for(let n=0;n<100;n++){const i=document.createElement("div");"player"===e?i.classList.add("gameBoardDiv"):"AI"===e&&i.classList.add("gameBoardDivAI"),n<10?(i.innerHTML=o,o++):10==n?i.innerHTML="1":20==n?i.innerHTML="2":30==n?i.innerHTML="3":40==n?i.innerHTML="4":50==n?i.innerHTML="5":60==n?i.innerHTML="6":70==n?i.innerHTML="7":80==n?i.innerHTML="8":90==n&&(i.innerHTML="9"),t.appendChild(i)}},s=new class{constructor(){this.name="AI",this.gameboard=new o,this.shoots=[],this.score=this.gameboard.sunkedShips,this.counter=0}init(){for(let e=this.counter;this.gameboard.ships.length<10;e++){if(9==this.gameboard.ships.length)return this.gameboard;let e=Math.floor(9*Math.random()),t=Math.floor(9*Math.random()),o=Math.floor(3*Math.random());Math.floor(2*Math.random()+1),o<2?o="horizontal":o>=2&&(o="vertical"),this.gameboard.ships.length<2?this.createLongShip(e,t,o):this.gameboard.ships.length>=2&&this.gameboard.ships.length<5?this.createMediumShip(e,t,o):this.createSmallShip(e,t,o),this.counter++}}createLongShip(e,t,o){this.gameboard.addShip(e,t,3,o)}createMediumShip(e,t,o){this.gameboard.addShip(e,t,2,o)}createSmallShip(e,t,o){this.gameboard.addShip(e,t,1,o)}shoot(){let e=Math.floor(9*Math.random()),t=Math.floor(9*Math.random());return this.shoots.push({x:e,y:t}),[e,t]}};let r=!1;(()=>{const e=document.createElement("header"),t=document.createElement("h1");t.innerText="BattleShip",e.appendChild(t),document.body.appendChild(e);const o=document.createElement("section");o.classList.add("preLoad");const n=document.createElement("div"),i=document.createElement("label");i.innerText="Type your name";const s=document.createElement("input");s.name="myName";const r=document.createElement("button");r.classList.add("submitMyName"),r.innerText="START",n.appendChild(i),n.appendChild(s),n.appendChild(r),o.appendChild(n),document.body.appendChild(o);const a=document.createElement("main"),d=document.createElement("section");d.id="player";const l=document.createElement("div");l.classList.add("div-input"),l.innerHTML='<span><h2 id="yourName">Name</h2></span>\n    <span><h3 class="infoPlayer">Type coordinates for<h4 class="shipWidth">big ship</h4></h3></span>\n    <h3 class="coordXInfo">X</h3>\n    <input id="coordinateX" type="number" />\n    <h3 class="coordYInfo">Y</h3>\n    <input id="coordinateY" type="number" />\n    <h4 class="positionInfoPlayer" style="width:70%;text-align:center;">Position(vertical,horizontal)</h4>\n    <input style="width:30%;" id="position" type="text" />\n    <button id="placeShip">Place ship</button>\n    <span>Score:<h2 class="playerScore">0</h2></span>',d.appendChild(l);const h=document.createElement("div");h.id="gameBoardPlayer";const c=document.createElement("div");c.id="divHolder",h.appendChild(c),d.appendChild(h),a.appendChild(d);const u=document.createElement("section");u.id="ai";const p=document.createElement("h2");p.innerText="AI GameBoard";const m=document.createElement("span");m.innerHTML='Score:<h2 class="aiScore">0</h2></span>',u.appendChild(p),u.appendChild(m);const g=document.createElement("div");g.id="gameBoardAI";const y=document.createElement("div");y.id="divAIHolder",g.appendChild(y),u.appendChild(g),a.appendChild(u),a.classList.add("hidden"),document.body.appendChild(a)})(),(()=>{const e=document.querySelector(".submitMyName"),t=document.querySelector(".preLoad div input");e.addEventListener("click",(()=>{""==t.value?alert("Type your name"):(n.welcome(),document.querySelector(".preLoad").classList.add("hidden"),document.querySelector("main").classList.remove("hidden"),i("player"),console.log(n))}))})(),document.querySelector("#placeShip").addEventListener("click",(()=>{if(!0===r)return;const e=document.querySelector("#coordinateX").value,t=document.querySelector("#coordinateY").value,o=document.querySelector("#position").value,a=document.querySelector(".shipWidth");let d=3;n.gameboard.ships.length>=2&&(d=2),n.gameboard.ships.length>=5&&(d=1),(8!=e&&9!=e||"horizontal"!==o||3!=d)&&(9==e&&"horizontal"===o&&2==d||(8!=t&&9!=t||"vertical"!==o||3!=d)&&(9==t&&"vertical"===o&&2==d||(""===e||""===t||""===o?console.log("type correct properties"):e>=0&&e<10&&t>=0&&t<10&&("vertical"===o||"horizontal"===o?(n.gameboard.addShip(e,t,d,o),n.gameboard.ships.length>=2&&(a.innerHTML="medium ship"),n.gameboard.ships.length>=5&&(a.innerHTML="small ship")):console.log("error")),9===n.gameboard.ships.length&&(i("AI"),document.querySelector("#placeShip").setAttribute("disabled",!0),setTimeout((()=>{s.init(),console.log(s)}),200),(()=>{const e=document.querySelectorAll(".gameBoardDivAI"),t=document.querySelectorAll(".gameBoardDiv"),o=Array.from(e);let i=[];o.forEach((t=>{t.addEventListener("click",(()=>{let n=o.indexOf(t).toString();if(-1===i.indexOf(+n)){let t,o;n>10?(n.split(" "),t=n[1],o=n[0]):10==n?(t=0,o=1):(t=n,o=0),i.push(+n),s.gameboard.receiveAttack(+t,+o),console.log(s.gameboard.hitsMissed),e[+n].style="background-color:green",a("AI"),r()}else console.log("byÅ‚o")}))}));const r=()=>{let e=s.shoot(),o=e[0],i=e[1],r=0;r=0==i?o:10*i+o,n.gameboard.receiveAttack(o,i),t[r].style="background-color:red",a("player")},a=o=>{if("AI"===o){let t=s.gameboard.hitsMissed;for(let o=0;o<t.length;o++)e[t[o]].innerHTML="x",e[t[o]].style="background-color:blue"}else if("player"===o){let e=n.gameboard.hitsMissed;for(let o=0;o<e.length;o++)t[e[o]].innerHTML="x",t[e[o]].style="background-color:blue"}}})(),r=!0))))}))})();